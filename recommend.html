<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>推荐</title>
    <link rel="stylesheet" href="./src/css/global.css">
    <link rel="stylesheet" href="./src/font_qianqian/iconfont.css">
    <link rel="stylesheet" href="./src/css/recommend.css">
    <script src="./src/js/zipto.js"></script>
    <script src="./src/js/rem.js"></script>
    <script src="https://cdn.bootcss.com/iScroll/5.2.0/iscroll-probe.min.js"></script>

</head>

<body>
    <div class="r_outerwrap">
        <div class="r_innerwrap">
            <div class="r_top_img">
                <img src="./src/images/recommend_top.png" alt="">
            </div>
            <div class="r_title">
                <div class="r_t_left">
                    <span class='r_title_txt active'>商家排行榜</span>
                </div>
                <div class="r_t_right">
                    <span class='r_title_txt'>商家优惠</span>
                </div>
            </div>


            <div class="r_rank">
                <ul class="r_rank_list">
                    <li>
                        <a href="#">
                            <span class="rank_num ">1</span>
                            <div class="boxF">
                                <div class="boxS">
                                    <div class="boxT" style="background-image: url(123.png);">

                                    </div>
                                </div>
                            </div>
                            <span class="rank_name ellipsis">洗车店洗车店洗车店</span>
                            <span class="rank_score">4.7</span>
                        </a>
                    </li>

                    <li>
                        <a href="#">
                            <span class="rank_num ">1</span>
                            <div class="boxF">
                                <div class="boxS">
                                    <div class="boxT" style="background-image: url(123.png);">

                                    </div>
                                </div>
                            </div>
                            <span class="rank_name ellipsis">洗车店洗车店洗车店</span>
                            <span class="rank_score">4.7</span>
                        </a>
                    </li>

                    <li>
                        <a href="#">
                            <span class="rank_num ">1</span>
                            <div class="boxF">
                                <div class="boxS">
                                    <div class="boxT" style="background-image: url(123.png);">

                                    </div>
                                </div>
                            </div>
                            <span class="rank_name ellipsis">洗车店洗车店洗车店</span>
                            <span class="rank_score">4.7</span>
                        </a>
                    </li>

                    <li>
                        <a href="#">
                            <span class="rank_num ">1</span>
                            <div class="boxF">
                                <div class="boxS">
                                    <div class="boxT" style="background-image: url(123.png);">

                                    </div>
                                </div>
                            </div>
                            <span class="rank_name ellipsis">洗车店洗车店洗车店</span>
                            <span class="rank_score">4.7</span>
                        </a>
                    </li>

                    <li>
                        <a href="#">
                            <span class="rank_num ">1</span>
                            <div class="boxF">
                                <div class="boxS">
                                    <div class="boxT" style="background-image: url(123.png);">

                                    </div>
                                </div>
                            </div>
                            <span class="rank_name ellipsis">洗车店洗车店洗车店</span>
                            <span class="rank_score">4.7</span>
                        </a>
                    </li>

                    <li>
                        <a href="#">
                            <span class="rank_num ">1</span>
                            <div class="boxF">
                                <div class="boxS">
                                    <div class="boxT" style="background-image: url(123.png);">

                                    </div>
                                </div>
                            </div>
                            <span class="rank_name ellipsis">洗车店洗车店洗车店</span>
                            <span class="rank_score">4.7</span>
                        </a>
                    </li>

                    <li>
                        <a href="#">
                            <span class="rank_num ">1</span>
                            <div class="boxF">
                                <div class="boxS">
                                    <div class="boxT" style="background-image: url(123.png);">

                                    </div>
                                </div>
                            </div>
                            <span class="rank_name ellipsis">洗车店洗车店洗车店</span>
                            <span class="rank_score">4.7</span>
                        </a>
                    </li>

                    <li>
                        <a href="#">
                            <span class="rank_num ">1</span>
                            <div class="boxF">
                                <div class="boxS">
                                    <div class="boxT" style="background-image: url(123.png);">

                                    </div>
                                </div>
                            </div>
                            <span class="rank_name ellipsis">洗车店洗车店洗车店</span>
                            <span class="rank_score">4.7</span>
                        </a>
                    </li>


                </ul>
            </div>
            <div class="r_discounts">
                <ul class="rd_list">
                    <li>
                        <a href="#">
                            <div class='rd_top'>
                                <img src="./src/images/shop_icon.png" alt="">
                                <span class='rd_shopname'>靓车会靓车会汕头店</span>
                                <span class="rd_location"><i class="icon iconfont icon-dingwei dingwei_icon"></i>距您153米</span>
                            </div>
                            <div class="rd_content">
                                <img src="./src/images/sd_product_1.png" alt="">
                                <div class='rdc_info'>
                                    <span>商品名商品名商品名</span>
                                    <strong class="rd_newprice">￥90</strong>
                                    <i class="rd_oldprice">￥120</i>
                                </div>
                                <div class="rd_buyBtn">购买</div>
                            </div>
                        </a>
                    </li>
                    <li>
                        <a href="#">
                            <div class='rd_top'>
                                <img src="./src/images/shop_icon.png" alt="">
                                <span class='rd_shopname'>靓车会靓车会汕头店</span>
                                <span class="rd_location"><i class="icon iconfont icon-dingwei dingwei_icon"></i>距您153米</span>
                            </div>
                            <div class="rd_content">
                                <img src="./src/images/sd_product_1.png" alt="">
                                <div class='rdc_info'>
                                    <span>商品名商品名商品名</span>
                                    <strong class="rd_newprice">￥90</strong>
                                    <i class="rd_oldprice">￥120</i>
                                </div>
                                <div class="rd_buyBtn">购买</div>
                            </div>
                        </a>
                    </li>
                    <li>
                        <a href="#">
                            <div class='rd_top'>
                                <img src="./src/images/shop_icon.png" alt="">
                                <span class='rd_shopname'>靓车会靓车会汕头店</span>
                                <span class="rd_location"><i class="icon iconfont icon-dingwei dingwei_icon"></i>距您153米</span>
                            </div>
                            <div class="rd_content">
                                <img src="./src/images/sd_product_1.png" alt="">
                                <div class='rdc_info'>
                                    <span>商品名商品名商品名</span>
                                    <strong class="rd_newprice">￥90</strong>
                                    <i class="rd_oldprice">￥120</i>
                                </div>
                                <div class="rd_buyBtn">购买</div>
                            </div>
                        </a>
                    </li>
                    <li>
                        <a href="#">
                            <div class='rd_top'>
                                <img src="./src/images/shop_icon.png" alt="">
                                <span class='rd_shopname'>靓车会靓车会汕头店</span>
                                <span class="rd_location"><i class="icon iconfont icon-dingwei dingwei_icon"></i>距您153米</span>
                            </div>
                            <div class="rd_content">
                                <img src="./src/images/sd_product_1.png" alt="">
                                <div class='rdc_info'>
                                    <span>商品名商品名商品名</span>
                                    <strong class="rd_newprice">￥90</strong>
                                    <i class="rd_oldprice">￥120</i>
                                </div>
                                <div class="rd_buyBtn">购买</div>
                            </div>
                        </a>
                    </li>
                    <li>
                        <a href="#">
                            <div class='rd_top'>
                                <img src="./src/images/shop_icon.png" alt="">
                                <span class='rd_shopname'>靓车会靓车会汕头店</span>
                                <span class="rd_location"><i class="icon iconfont icon-dingwei dingwei_icon"></i>距您153米</span>
                            </div>
                            <div class="rd_content">
                                <img src="./src/images/sd_product_1.png" alt="">
                                <div class='rdc_info'>
                                    <span>商品名商品名商品名</span>
                                    <strong class="rd_newprice">￥90</strong>
                                    <i class="rd_oldprice">￥120</i>
                                </div>
                                <div class="rd_buyBtn">购买</div>
                            </div>
                        </a>
                    </li>
                    <li>
                        <a href="#">
                            <div class='rd_top'>
                                <img src="./src/images/shop_icon.png" alt="">
                                <span class='rd_shopname'>靓车会靓车会汕头店</span>
                                <span class="rd_location"><i class="icon iconfont icon-dingwei dingwei_icon"></i>距您153米</span>
                            </div>
                            <div class="rd_content">
                                <img src="./src/images/sd_product_1.png" alt="">
                                <div class='rdc_info'>
                                    <span>商品名商品名商品名</span>
                                    <strong class="rd_newprice">￥90</strong>
                                    <i class="rd_oldprice">￥120</i>
                                </div>
                                <div class="rd_buyBtn">购买</div>
                            </div>
                        </a>
                    </li>
                    <li>
                        <a href="">
                            <div class='rd_top'>
                                <img src="./src/images/shop_icon.png" alt="">
                                <span class='rd_shopname'>靓车会靓车会汕头店</span>
                                <span class="rd_location"><i class="icon iconfont icon-dingwei dingwei_icon"></i>距您153米</span>
                            </div>
                            <div class="rd_content">
                                <img src="./src/images/sd_product_1.png" alt="">
                                <div class='rdc_info'>
                                    <span>商品名商品名商品名</span>
                                    <strong class="rd_newprice">￥90</strong>
                                    <i class="rd_oldprice">￥120</i>
                                </div>
                                <div class="rd_buyBtn">购买</div>
                            </div>
                        </a>
                    </li>
                </ul>

            </div>
        </div>
    </div>
    <div class="tabbar">
        <a class='gradient-text'>
            <i class="icon iconfont icon-xiche-cuxiantiao "></i>
            <span class='gradient-text'>洗车</span>

        </a>

        <a>
            <i class="icon iconfont icon-zhinanzhen"></i>
            <span>推荐</span>
        </a>

        <a>
            <i class="icon iconfont icon-wode2"></i>
            <span>我的</span>
        </a>
    </div>

</body>

</html>
<script>
    $(function () {
        var str_rank = ``;
        var str_discount = ``;
        var count = 0;
        var cityid = 84;
        var loadingStep = 0;
        //初次加载商家排行数据
        $('.r_title_txt').each(function (ind, ele) {
            if ($(ele).hasClass('active')) {
                $(ele).children().show();
            }
            if ($(ele).text() == '商家排行榜') {

                if (str_rank.length != 0) {

                    $('.r_rank_list').html(str_rank);
                    return;
                }
                $.get('http://stqqkj.com/index.php/Home/Mobile/ShoplistByscore/page/0/cityid/' + cityid,
                    function (res) {
                        var res = JSON.parse(res)

                        if (res.resultCode == 0) {
                            str_rank += handleResult(res);
                            $('.r_rank_list').html(str_rank)

                        }
                    })
            }
        })

        function handleResult(res) {
            var str = ``;
            res.data.forEach((ele) => {
                count++;
                str +=
                    `<li>
                <a href="#">
                    <span class="rank_num ">${count}</span>
                    <div class="boxF">
                        <div class="boxS">
                            <div class="boxT" style="background-image: url(${ele.logo});">

                            </div>
                        </div>
                    </div>
                    <span class="rank_name ellipsis">${ele.shop_name}</span>
                    <span class="rank_score">${ele.score}</span>
                </a>
            </li>`
            })
            return str;

        }

        $('.r_title_txt').click(function () {
            $(this).addClass('active').parent().siblings().children('.r_title_txt').removeClass(
                'active');
            $(this).children().show();
            $(this).parent().siblings().children().children().hide();

            if ($(this).text() == '商家排行榜') {
                $('.r_rank').show();
                $('.r_discounts').hide();
            }
            if ($(this).text() == '商家优惠') {
                $('.r_rank').hide();
                $('.r_discounts').show();
            }

        })



        $('.tabbar a').click(function (e) {
            var target = e.currentTarget;
            $(target).addClass('gradient-text').siblings().removeClass('gradient-text').children().removeClass(
                'gradient-text')

        })
    })


    myScroll = new IScroll(".r_outerwrap", {
        scrollbars: true,
        mouseWheel: false,
        interactiveScrollbars: true,
        shrinkScrollbars: "scale",
        fadeScrollbars: true,
        scrollY: true,
        probeType: 2,
        bindToWrapper: true,
        preventDefault: false
    });
    myScroll.on("scroll", function () {
        if (this.maxScrollY - this.y >= 60 && loadingStep == 0) {
            //下拉后加载更多
            loadingStep = 1;
            pullUpAction();
        }

    });

    function pullUpAction() {

    }
</script>